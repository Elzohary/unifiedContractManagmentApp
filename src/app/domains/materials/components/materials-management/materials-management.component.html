<div class="materials-management-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Materials Management</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <!-- Filters Section -->
      <div class="filters-section">
        <!-- Material Type Filter -->
        <mat-form-field appearance="outline">
          <mat-label>Material Type</mat-label>
          <mat-select (selectionChange)="onFilterByMaterialType($event.value)">
            <mat-option [value]="">All Types</mat-option>
            <mat-option [value]="materialTypes.RECEIVABLE">Receivable</mat-option>
            <mat-option [value]="materialTypes.PURCHASABLE">Purchasable</mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Client Type Filter -->
        <mat-form-field appearance="outline">
          <mat-label>Client</mat-label>
          <mat-select (selectionChange)="onFilterByClientType($event.value)">
            <mat-option [value]="">All Clients</mat-option>
            <mat-option [value]="clientTypes.SEC">SEC</mat-option>
            <!-- Add other clients as they are added to the system -->
          </mat-select>
        </mat-form-field>

        <!-- Search Field -->
        <mat-form-field appearance="outline">
          <mat-label>Search</mat-label>
          <input matInput placeholder="Search materials..." #searchInput (keyup)="onSearch(searchInput.value)">
          <button *ngIf="searchInput.value" matSuffix mat-icon-button aria-label="Clear" (click)="searchInput.value=''; onResetFilters()">
            âœ•
          </button>
        </mat-form-field>
      </div>

      <!-- Loading Spinner -->
      <div *ngIf="(loading$ | async) === true" class="loading-container">
        <mat-spinner diameter="40"></mat-spinner>
      </div>

      <!-- Materials Table -->
      <ng-container *ngIf="(loading$ | async) !== true">
        <ng-container *ngIf="(materials$ | async) as materials">
          <table mat-table [dataSource]="materials" class="mat-elevation-z1" *ngIf="materials.length > 0">
            <!-- Code Column -->
            <ng-container matColumnDef="code">
              <th mat-header-cell *matHeaderCellDef>Code</th>
              <td mat-cell *matCellDef="let material">{{material.code}}</td>
            </ng-container>

            <!-- Description Column -->
            <ng-container matColumnDef="description">
              <th mat-header-cell *matHeaderCellDef>Description</th>
              <td mat-cell *matCellDef="let material">{{material.description}}</td>
            </ng-container>

            <!-- Unit Column -->
            <ng-container matColumnDef="unit">
              <th mat-header-cell *matHeaderCellDef>Unit</th>
              <td mat-cell *matCellDef="let material">{{material.unit}}</td>
            </ng-container>

            <!-- Type Column -->
            <ng-container matColumnDef="materialType">
              <th mat-header-cell *matHeaderCellDef>Type</th>
              <td mat-cell *matCellDef="let material">{{material.materialType}}</td>
            </ng-container>

            <!-- Client Column -->
            <ng-container matColumnDef="clientType">
              <th mat-header-cell *matHeaderCellDef>Client</th>
              <td mat-cell *matCellDef="let material">{{material.clientType}}</td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Actions</th>
              <td mat-cell *matCellDef="let material">
                <button mat-button color="primary">View Details</button>
                <!-- <button mat-button color="accent">Assign</button> -->
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>

          <!-- No Data Message -->
          <div *ngIf="materials.length === 0" class="no-data-container">
            <p>No materials found. Try adjusting your filters.</p>
          </div>
        </ng-container>
      </ng-container>
    </mat-card-content>
  </mat-card>
</div>
